{"remainingRequest":"/Users/panbing/store/lang/doc/blog/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/panbing/store/lang/doc/blog/node_modules/vuepress-theme-api/components/CURL/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/panbing/store/lang/doc/blog/node_modules/vuepress-theme-api/components/CURL/index.vue","mtime":1620918715376},{"path":"/Users/panbing/store/lang/doc/blog/node_modules/cache-loader/dist/cjs.js","mtime":1620915890299},{"path":"/Users/panbing/store/lang/doc/blog/node_modules/babel-loader/lib/index.js","mtime":1620915889925},{"path":"/Users/panbing/store/lang/doc/blog/node_modules/cache-loader/dist/cjs.js","mtime":1620915890299},{"path":"/Users/panbing/store/lang/doc/blog/node_modules/vue-loader/lib/index.js","mtime":1620915890611}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBucHJvZ3Jlc3MgZnJvbSAnbnByb2dyZXNzJwoKaW1wb3J0IHJlcXVlc3QgZnJvbSAnLi4vLi4vaGVscGVycy9yZXF1ZXN0JwppbXBvcnQgY3VybCBmcm9tICcuLi8uLi9oZWxwZXJzL2N1cmwnCmltcG9ydCB7IGlzSlNPTiwgaXNRdWVyeVN0cmluZyB9IGZyb20gJy4uLy4uL2hlbHBlcnMvaXMnCgovLyBjb25maWd1cmUgcHJvZ3Jlc3MgYmFyCm5wcm9ncmVzcy5jb25maWd1cmUoewogIHNob3dTcGlubmVyOiBmYWxzZSwKfSkKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQ1VSTCcsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxpZ2h0QnRuOiB0cnVlLAogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgbmV0d29ya1BhbmVsVmlzaWJsZTogZmFsc2UsCiAgICAgIG5ldHdvcmtEYXRhOiB7CiAgICAgICAgbWV0aG9kOiAnJywKICAgICAgICB1cmw6ICcnLAogICAgICAgIGhlYWRlcnM6IHt9LAogICAgICAgIHJlcXVlc3Q6IHt9LAogICAgICAgIHJlc3BvbnNlOiB7fSwKICAgICAgICBzdGF1dHNDb2RlOiAnJywKICAgICAgICBzdGF0dXNUZXh0OiAnJywKICAgICAgfSwKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICBpZiAodGhpcy5ub3RJbkV4YW1wbGVCb3goKSkgewogICAgICB0aGlzLmxpZ2h0QnRuID0gZmFsc2UKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIG9wZW5OZXR3b3JrUGFuZWwoKSB7CiAgICAgIHRoaXMubmV0d29ya1BhbmVsVmlzaWJsZSA9IHRydWUKICAgIH0sCiAgICBzZW5kUmVxdWVzdCgpIHsKICAgICAgY29uc3QgY21kID0gdGhpcy4kcmVmcy5jdXJsLm91dGVyVGV4dC50cmltKCkKCiAgICAgIGlmICh0aGlzLmxvYWRpbmcpIHJldHVybgoKICAgICAgY29uc3Qgb3B0aW9ucyA9IGN1cmwoY21kKQoKICAgICAgaWYgKCFvcHRpb25zKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcigKICAgICAgICAgICdHb3QgYW4gaW52YWxpZCBDVVJMIGNvbW1hbmQsIHBsZWFzZSBjaGVjayBpdCBhbmQgdHJ5IGFnYWluLicKICAgICAgICApCiAgICAgICAgcmV0dXJuCiAgICAgIH0KCiAgICAgIGNvbnNvbGUuY2xlYXIoKQogICAgICBjb25zb2xlLmxvZygnPT09PT09IERFQlVHIElORk8gQkVHSU4gPT09PT09JykKICAgICAgY29uc29sZS5pbmZvKGA9PiAke29wdGlvbnMubWV0aG9kLnRvVXBwZXJDYXNlKCl9ICR7b3B0aW9ucy51cmx9YCkKCiAgICAgIHRoaXMubmV0d29ya0RhdGEubWV0aG9kID0gb3B0aW9ucy5tZXRob2QudG9VcHBlckNhc2UoKQogICAgICB0aGlzLm5ldHdvcmtEYXRhLnVybCA9IG9wdGlvbnMudXJsCgogICAgICBpZiAob3B0aW9ucy5oZWFkZXJzKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCc9PiBIZWFkZXJzOicsIG9wdGlvbnMuaGVhZGVycykKCiAgICAgICAgdGhpcy5uZXR3b3JrRGF0YS5oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzCiAgICAgIH0KCiAgICAgIGlmIChvcHRpb25zLnBhcmFtcykgewogICAgICAgIGNvbnNvbGUuaW5mbygnPT4gUGFyYW1zOicsIG9wdGlvbnMucGFyYW1zKQogICAgICB9CgogICAgICBpZiAob3B0aW9ucy5kYXRhKSB7CiAgICAgICAgY29uc29sZS5pbmZvKCc9PiBEYXRhOicsIG9wdGlvbnMuZGF0YSkKCiAgICAgICAgdGhpcy5uZXR3b3JrRGF0YS5kYXRhID0gb3B0aW9ucy5kYXRhCiAgICAgIH0KCiAgICAgIHRoaXMub3BlbkxvYWRpbmcoKQoKICAgICAgcmVxdWVzdChvcHRpb25zKQogICAgICAgIC50aGVuKChkYXRhKSA9PiB7CiAgICAgICAgICB0aGlzLmNsb3NlTG9hZGluZygpCgogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKAogICAgICAgICAgICBgJHtkYXRhLnN0YXR1c30gJHtkYXRhLmRhdGEubWVzc2FnZSB8fCBkYXRhLnN0YXR1c1RleHR9YAogICAgICAgICAgKQoKICAgICAgICAgIHRoaXMubmV0d29ya0RhdGEuc3RhdHVzQ29kZSA9IGAke2RhdGEuc3RhdHVzfWAKICAgICAgICAgIHRoaXMubmV0d29ya0RhdGEuc3RhdHVzVGV4dCA9IGRhdGEuc3RhdHVzVGV4dAogICAgICAgICAgdGhpcy5uZXR3b3JrRGF0YS5yZXNwb25zZSA9IGRhdGEuZGF0YQoKICAgICAgICAgIGNvbnNvbGUuaW5mbygnPD0nLCBkYXRhLnN0YXR1cywgZGF0YS5zdGF0dXNUZXh0KQogICAgICAgICAgY29uc29sZS5pbmZvKCc8PScsICdkYXRhOicsIGRhdGEuZGF0YSkKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7CiAgICAgICAgICB0aGlzLmNsb3NlTG9hZGluZygpCgogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihgJHtlcnIuc3RhdHVzfSAke2Vyci5tZXNzYWdlfWApCgogICAgICAgICAgdGhpcy5uZXR3b3JrRGF0YS5zdGF0dXNDb2RlID0gYCR7ZXJyLnN0YXR1c31gCiAgICAgICAgICB0aGlzLm5ldHdvcmtEYXRhLnN0YXR1c1RleHQgPSBlcnIubWVzc2FnZQogICAgICAgICAgdGhpcy5uZXR3b3JrRGF0YS5yZXNwb25zZSA9IGVyci5kYXRhCgogICAgICAgICAgY29uc29sZS5lcnJvcignPD0nLCBlcnIpCiAgICAgICAgfSkKICAgICAgICAuZmluYWxseSgoKSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZygnPT09PT09IERFQlVHIElORk8gRU5EID09PT09PScpCgogICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICAgIHRoaXMub3Blbk5ldHdvcmtQYW5lbCgpCiAgICAgICAgICB9LCAzMDApCiAgICAgICAgfSkKICAgIH0sCiAgICBub3RJbkV4YW1wbGVCb3goKSB7CiAgICAgIHJldHVybiB0aGlzLiRlbC5wYXJlbnROb2RlLmdldEF0dHJpYnV0ZSgndHlwZScpICE9PSAnZXhhbXBsZScKICAgIH0sCiAgICBvcGVuTG9hZGluZygpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQoKICAgICAgbnByb2dyZXNzLnN0YXJ0KCkKICAgIH0sCiAgICBjbG9zZUxvYWRpbmcoKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCgogICAgICBucHJvZ3Jlc3MuZG9uZSgpCiAgICB9LAogIH0sCn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;AAaA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"node_modules/vuepress-theme-api/components/CURL","sourcesContent":["<template>\n  <div class=\"curl__container\">\n    <div ref=\"curl\" class=\"curl__body\" contenteditable>\n      <slot></slot>\n    </div>\n    <Button :light=\"lightBtn\" :loading=\"loading\" @click=\"sendRequest\"\n      >Send request now</Button\n    >\n    <NetworkPanel :visible.sync=\"networkPanelVisible\" v-bind=\"networkData\" />\n  </div>\n</template>\n\n<script>\nimport nprogress from 'nprogress'\n\nimport request from '../../helpers/request'\nimport curl from '../../helpers/curl'\nimport { isJSON, isQueryString } from '../../helpers/is'\n\n// configure progress bar\nnprogress.configure({\n  showSpinner: false,\n})\n\nexport default {\n  name: 'CURL',\n  data() {\n    return {\n      lightBtn: true,\n      loading: false,\n      networkPanelVisible: false,\n      networkData: {\n        method: '',\n        url: '',\n        headers: {},\n        request: {},\n        response: {},\n        stautsCode: '',\n        statusText: '',\n      },\n    }\n  },\n  mounted() {\n    if (this.notInExampleBox()) {\n      this.lightBtn = false\n    }\n  },\n  methods: {\n    openNetworkPanel() {\n      this.networkPanelVisible = true\n    },\n    sendRequest() {\n      const cmd = this.$refs.curl.outerText.trim()\n\n      if (this.loading) return\n\n      const options = curl(cmd)\n\n      if (!options) {\n        this.$message.error(\n          'Got an invalid CURL command, please check it and try again.'\n        )\n        return\n      }\n\n      console.clear()\n      console.log('====== DEBUG INFO BEGIN ======')\n      console.info(`=> ${options.method.toUpperCase()} ${options.url}`)\n\n      this.networkData.method = options.method.toUpperCase()\n      this.networkData.url = options.url\n\n      if (options.headers) {\n        console.info('=> Headers:', options.headers)\n\n        this.networkData.headers = options.headers\n      }\n\n      if (options.params) {\n        console.info('=> Params:', options.params)\n      }\n\n      if (options.data) {\n        console.info('=> Data:', options.data)\n\n        this.networkData.data = options.data\n      }\n\n      this.openLoading()\n\n      request(options)\n        .then((data) => {\n          this.closeLoading()\n\n          this.$message.success(\n            `${data.status} ${data.data.message || data.statusText}`\n          )\n\n          this.networkData.statusCode = `${data.status}`\n          this.networkData.statusText = data.statusText\n          this.networkData.response = data.data\n\n          console.info('<=', data.status, data.statusText)\n          console.info('<=', 'data:', data.data)\n        })\n        .catch((err) => {\n          this.closeLoading()\n\n          this.$message.error(`${err.status} ${err.message}`)\n\n          this.networkData.statusCode = `${err.status}`\n          this.networkData.statusText = err.message\n          this.networkData.response = err.data\n\n          console.error('<=', err)\n        })\n        .finally(() => {\n          console.log('====== DEBUG INFO END ======')\n\n          setTimeout(() => {\n            this.openNetworkPanel()\n          }, 300)\n        })\n    },\n    notInExampleBox() {\n      return this.$el.parentNode.getAttribute('type') !== 'example'\n    },\n    openLoading() {\n      this.loading = true\n\n      nprogress.start()\n    },\n    closeLoading() {\n      this.loading = false\n\n      nprogress.done()\n    },\n  },\n}\n</script>\n\n<style lang=\"stylus\">\n.curl\n  &__body\n    outline: none\n</style>\n"]}]}